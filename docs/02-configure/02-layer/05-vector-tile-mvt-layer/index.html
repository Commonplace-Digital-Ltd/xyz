<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/x-icon" href="/icons/favicon.ico">
  <title>MapBox Vector Tile (MVT) Layer</title>
  <style>

    body {
      margin: 0;
      padding: 0;
    }

    .grid {
      font-family: system-ui;
      display:grid;
      grid-template-columns: 1fr 5fr;
      max-width: 1100px;
      margin: auto;
      padding: 0 30px;
    }

    #toggle {
        display: none;
    }

    #toggle:hover {
      cursor: pointer;
    }

    #nav {
      grid-column: 1;
      padding-inline-start: 0px;
      list-style-type: none;
      padding-right: 20px;
      margin: 10px 0;
    }

    #nav > *:first-child {
      line-height: 1;
    }

    #content {
      grid-column: 2;
      padding-left: 20px;
      border-left: 1px solid #ddd;
      margin: 10px 0;
    }

    #content > *:first-child {
      margin: 0;
    }

    .active {
      font-weight: bold;
    }

    a {
      text-decoration: none;
      white-space: nowrap;
      color: #333;
    }

    h1, h2, h3 {
      margin-bottom: 0.5em;
    }

    p {
      margin-top: 0.5em;
      line-height: 1.5;
    }

    li {
      line-height: 1.5;
    }

    li._1 {
      padding-left: 0px;
    }

    li._2 {
      padding-left: 20px;
    }

    li.__2 {
      padding-left: 0px;
    }

    li._3 {
      padding-left: 40px;
    }

    li.__3 {
      padding-left: 20px;
    }

    pre {
      display: block;
      font-family: monospace;
      white-space: pre;
      margin: 1em 0;
      padding: 15px;
      box-shadow: 0 0 2px #555;
      overflow-x: auto;
      background-color: #f0f0f0;
    }

    code {
      font-family: monospace;
      background-color: #f0f0f0;
    }

    *:not(pre) > code {
      padding: 5px;
    }

    #content a {
      color: #090;
    }

    #content img {
      max-width: 100%;
      display: block;
      margin: 0 auto;
    }

    @media only screen and (max-width: 700px) {
      .grid {
        grid-template-columns: 0 1fr;
        padding: 0 0 0 40px;
      }

      #toggle {
        display: block;
        position: fixed;
        top: 10px;
        left: 10px;        
        width: 20px;
        height: 30px;
        background: repeating-linear-gradient(#ddd, #fff 10px);
      }

      #nav {
        display: none;
      }

      #content {
        border-left: none;
        padding: 0 20px 0 1px;
        overflow: hidden;
      }
    }

    .show_nav {
      grid-template-columns: 1fr 2fr;
    }

    .show_nav > #nav {
      display: block;
    }

    .show_nav > #content * {
      font-size: 30%;
      padding: 0;
      overflow: hidden;
    }
  </style>

</head>

<body>

  <div class="grid">

    <div id="toggle"></div>

    <ul id="nav">

      <li>
        <a style="font-weight: bold; font-size: 30px;" href="https://geolytix.github.io/xyz/docs">XYZ</a>
      </li>
      
      
      
      
      
      
      
      
      
      
      
      <li class="_1 __1 ">
        <a href="https://geolytix.github.io/xyz/docs/02-configure/00-configure/">Configure</a>
      </li>
      
      
      
      <li class="_1  ">
        <a href="https://geolytix.github.io/xyz/docs/02-configure/01-locale/">Locale</a>
      </li>
      
      
      
      <li class="_2 __2 ">
        <a href="https://geolytix.github.io/xyz/docs/02-configure/02-layer/00-layers/">Layer</a>
      </li>
      
      
      
      <li class="_2  ">
        <a href="https://geolytix.github.io/xyz/docs/02-configure/02-layer/01-tile-layer/">Tile Layer</a>
      </li>
      
      
      
      <li class="_2  ">
        <a href="https://geolytix.github.io/xyz/docs/02-configure/02-layer/02-postgis-layer/">PostGIS Data Layer</a>
      </li>
      
      
      
      <li class="_2  ">
        <a href="https://geolytix.github.io/xyz/docs/02-configure/02-layer/03-cluster-layer/">Cluster Layer</a>
      </li>
      
      
      
      <li class="_2  ">
        <a href="https://geolytix.github.io/xyz/docs/02-configure/02-layer/04-geojson-layer/">GeoJson Layer</a>
      </li>
      
      
      
      <li class="_2  active">
        <a href="https://geolytix.github.io/xyz/docs/02-configure/02-layer/05-vector-tile-mvt-layer/">MapBox Vector Tile (MVT) Layer</a>
      </li>
      
      
      
      <li class="_2  ">
        <a href="https://geolytix.github.io/xyz/docs/02-configure/02-layer/06-grid-hex/">Grid (Hex) Layer</a>
      </li>
      
      
      
      <li class="_2  ">
        <a href="https://geolytix.github.io/xyz/docs/02-configure/02-layer/07-filter/">Filter</a>
      </li>
      
      
      
      <li class="_2  ">
        <a href="https://geolytix.github.io/xyz/docs/02-configure/02-layer/08-dataviews/">Dataviews</a>
      </li>
      
      
      
      <li class="_2 __2 ">
        <a href="https://geolytix.github.io/xyz/docs/02-configure/03-location/00-infoj/">Location</a>
      </li>
      
      
      
      <li class="_2  ">
        <a href="https://geolytix.github.io/xyz/docs/02-configure/03-location/01-groups/">Groups</a>
      </li>
      
      
      
      <li class="_2  ">
        <a href="https://geolytix.github.io/xyz/docs/02-configure/03-location/02-filter/">Filter</a>
      </li>
      
      
      
      <li class="_2  ">
        <a href="https://geolytix.github.io/xyz/docs/02-configure/03-location/04-geometry/">Geometry</a>
      </li>
      
      
      
      <li class="_2  ">
        <a href="https://geolytix.github.io/xyz/docs/02-configure/03-location/05-dataviews/">Dataviews</a>
      </li>
      
      
      
      <li class="_1 __1 ">
        <a href="https://geolytix.github.io/xyz/docs/02-configure/04-gazetteer/">Gazetteer</a>
      </li>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      

    </ul>

    <div id="content">
      <p>MVT layer are vector layers which read the geometry column from a PostGIS table. The XYZ backend splits the map view into tiles and compresses the geometry as well as properties into the vector tile PBF format using the <a href="https://www.mapbox.com/vector-tiles/specification">MapBox Vector Tile specification</a>.</p>
<h3><strong>MVT geometry</strong></h3>
<p><code>&quot;geom_3827&quot;: &quot;geom_3857&quot;</code></p>
<p>MVT layer require a PostGIS geometry column of the type GEOMETRY(POLYGON,3857) or GEOMETRY(MULTIPOLYGON,3857). By default the geom value will be set to 'geom_3857'.</p>
<h2>MVT parameter</h2>
<p>Geometries rendered in a Mapbox Vector Tile may have encoded attributes which can be used to style the feature in the client map. The list of attributes to be rendered into MVTs is defined in the mvt_fields layer entry. Without the encoded attribute rendered into a tile a theme which uses the respective field may not be applied.</p>
<p><code>&quot;mvt_fields&quot;: [&quot;location_type&quot;, &quot;location_income&quot;, &quot;price&quot;]</code></p>
<p>It is possible to assign SQL as fields to be used in themes.</p>
<pre><code class="language-text">&quot;mvt_fields&quot;: [
  &quot;pop_est&quot;,
  &quot;gdp_md_est&quot;,
  &quot;gdp_md_est_edit::numeric / (pop_est_edit::numeric + 1) * 1000 as gdp_pp&quot;,
  &quot;(pop_est_edit / st_area(geom_3857)) * 1000 as pop_dens&quot;
]
</code></pre>
<p>The fields gdp_pp and pop_dens which do not exist in the PostGIS table itself may now be used in themes as field definition. The calculated values will be stored in cached tiles.</p>
<p>Tile caches need to be truncated if the list of attribute fields changes.</p>
<p>It is possible to enable the caching backend rendered MVT thus reducing the response time when accessing accessing cached tiles.</p>
<p><code>&quot;mvt_cache&quot;: &quot;{tablename}__mvts&quot;</code></p>
<p>The cache table will be generated during the workspace load sequence. Cached tiles contain a list of table fields. The cache table will be truncated (during workspace load sequence) if the list is changed to include fields which were not previously contained in cached tiles.</p>
<h2><strong>MVT locations</strong></h2>
<p><code>&quot;qID&quot;: &quot;optional&quot;</code></p>
<p>Setting the <strong>qID</strong> as a valid id column for the database table will make vector locations selectable. There is no default for the qID value. The qID value together with the table and dbs parameter will be tested during the workspace load.</p>
<p>Additional parameter will be discussed in the locations section of this document.</p>
<h2>MVT styling</h2>
<p>Strokes as well as polygon fills can be styled for vector layers. In order to select a layer a transparent fill must be applied. Otherwise the polygon will be drawn as an outline only.</p>
<pre><code class="language-javascript">&quot;style&quot;: {
  &quot;default&quot;: {
      &quot;weight&quot;: 1,
      &quot;color&quot;: &quot;#333333&quot;,
      &quot;fill&quot;: true,
      &quot;fillColor&quot;: &quot;#333333&quot;,
      &quot;fillOpacity&quot;: 0.1
  },
  &quot;highlight&quot;: {
      &quot;weight&quot;: 2,
      &quot;color&quot;: &quot;#009900&quot;,
      &quot;fill&quot;: true,
      &quot;fillColor&quot;: &quot;#ccff99&quot;,
      &quot;fillOpacity&quot;: 0.2
  },
  &quot;themes&quot;: {}
}
</code></pre>
<p>The highlight style is applied when the mouse cursor hovers over a selectable item.</p>
<h2><strong>Vector themes</strong></h2>
<p>Categorized and graduated themes can be applied to vector layers (MVT / GeoJSON).</p>
<p><strong>Theme styles are adaptive.</strong> The marker and markerMulti definition will be augmented by the style elements in theme's categories (cat).</p>
<h3>Categorized theme</h3>
<p>Categorized themes allow to paint vector maps with the style representing specific categories.</p>
<pre><code class="language-javascript">&quot;Retail Place type&quot;: {
  &quot;type&quot;: &quot;categorized&quot;,
  &quot;field&quot;: &quot;rp_type&quot;,
  &quot;other&quot;: true,
  &quot;cat&quot;: {
    &quot;Major City Centre&quot;: {
      &quot;label&quot;: &quot;Major City Centre&quot;,
      &quot;color&quot;: &quot;#EF271B&quot;,
      &quot;fillColor&quot;: &quot;#EF271B&quot;
    },
    &quot;City Centre&quot;: {
      &quot;label&quot;: &quot;City Centre&quot;,
      &quot;color&quot;: &quot;#BA2D0B&quot;,
      &quot;fillColor&quot;: &quot;#BA2D0B&quot;
    },
    &quot;Large Town Centre&quot;: {
      &quot;label&quot;: &quot;Large Town Centre&quot;,
      &quot;color&quot;: &quot;#FE4E00&quot;,
      &quot;fillColor&quot;: &quot;#FE4E00&quot;
    },
    &quot;Major Urban Centre&quot;: {
      &quot;label&quot;: &quot;Major Urban Centre&quot;,
      &quot;color&quot;: &quot;#E2711D&quot;,
      &quot;fillColor&quot;: &quot;#E2711D&quot;
    }
  }
}
</code></pre>
<p>A categorized theme requires as a minimum the type, field, and cat properties. The type is <strong>categorized</strong>. The <strong>field</strong> value must be a column in the PostGIS table which can be used to categorize a location. <strong>cat</strong> is an array like object which lists the different categories as key/value pairs. The key is used to identify the category of a location while the value defines the styling of the marker as well as the label which should be shown in the legend.</p>
<p><code>&quot;other&quot;: true</code></p>
<p>The other entry will show a marker for values which do not match a category key in the theme's legend.</p>
<p>Entries (label) in the categorized theme legend can be used to filter the respective category.</p>
<h3><strong>Graduated vector theme</strong></h3>
<p>Locations (vector features) fall into a graduated theme category when their (theme) field value is larger then the categories key (parsed) but smaller than the subsequent category's key (parsed).</p>
<pre><code class="language-coffeescript">&quot;Population '11&quot;: {
  &quot;type&quot;: &quot;graduated&quot;,
  &quot;field&quot;: &quot;pop_11&quot;,
  &quot;cat&quot;: {
      &quot;0&quot;: {
          &quot;label&quot;: &quot;0 to 10000&quot;,
          &quot;fillColor&quot;: &quot;#15773f&quot;
      },
      &quot;100&quot;: {
          &quot;label&quot;: &quot;10000 to 25000&quot;,
          &quot;fillColor&quot;: &quot;#66bd63&quot;
      },
      &quot;200&quot;: {
          &quot;label&quot;: &quot;25000 to 50000&quot;,
          &quot;fillColor&quot;: &quot;#a6d96a&quot;
      },
      &quot;300&quot;: {
          &quot;label&quot;: &quot;50000 to 100000&quot;,
          &quot;fillColor&quot;: &quot;#d9ef8b&quot;
      },
      &quot;400&quot;: {
          &quot;label&quot;: &quot;100000 to 250000&quot;,
          &quot;fillColor&quot;: &quot;#fdae61&quot;
      },
      &quot;500&quot;: {
          &quot;label&quot;: &quot;250000 to 500000&quot;,
          &quot;fillColor&quot;: &quot;#f46d43&quot;
      },
      &quot;600&quot;: {
          &quot;label&quot;: &quot;500000 or more&quot;,
          &quot;fillColor&quot;: &quot;#d73027&quot;
      }
  }
};
</code></pre>
<p>Graduated categories cannot be filtered from the legend.</p>

    </div>

  </div>

</body>

<script>
    const toggle = document.getElementById('toggle');

    toggle.onclick = e => { e.target.parentElement.classList.toggle('show_nav'); };
</script>

</html>