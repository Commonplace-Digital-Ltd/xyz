<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/x-icon" href="/icons/favicon.ico">
  <title>Security</title>
  <style>

    body {
      margin: 0;
      padding: 0;
    }

    .grid {
      font-family: system-ui;
      display:grid;
      grid-template-columns: 1fr 5fr;
      max-width: 1100px;
      margin: auto;
      padding: 0 30px;
    }

    #toggle {
        display: none;
    }

    #toggle:hover {
      cursor: pointer;
    }

    #nav {
      grid-column: 1;
      padding-inline-start: 0px;
      list-style-type: none;
      padding-right: 20px;
      margin: 10px 0;
    }

    #nav > *:first-child {
      line-height: 1;
    }

    #content {
      grid-column: 2;
      padding-left: 20px;
      border-left: 1px solid #ddd;
      margin: 10px 0;
    }

    #content > *:first-child {
      margin: 0;
    }

    .active {
      font-weight: bold;
    }

    a {
      text-decoration: none;
      white-space: nowrap;
      color: #333;
    }

    h1, h2, h3 {
      margin-bottom: 0.5em;
    }

    p {
      margin-top: 0.5em;
      line-height: 1.5;
    }

    li {
      line-height: 1.5;
    }

    li._1 {
      padding-left: 0px;
    }

    li._2 {
      padding-left: 20px;
    }

    li.__2 {
      padding-left: 0px;
    }

    li._3 {
      padding-left: 40px;
    }

    li.__3 {
      padding-left: 20px;
    }

    pre {
      display: block;
      font-family: monospace;
      white-space: pre;
      margin: 1em 0;
      padding: 15px;
      box-shadow: 0 0 2px #555;
      overflow-x: auto;
      background-color: #f0f0f0;
    }

    code {
      font-family: monospace;
      background-color: #f0f0f0;
    }

    *:not(pre) > code {
      padding: 5px;
    }

    #content a {
      color: #090;
    }

    #content img {
      max-width: 100%;
      display: block;
      margin: 0 auto;
    }

    @media only screen and (max-width: 700px) {
      .grid {
        grid-template-columns: 0 1fr;
        padding: 0 0 0 40px;
      }

      #toggle {
        display: block;
        position: fixed;
        top: 10px;
        left: 10px;        
        width: 20px;
        height: 30px;
        background: repeating-linear-gradient(#ddd, #fff 10px);
      }

      #nav {
        display: none;
      }

      #content {
        border-left: none;
        padding: 0 20px 0 1px;
        overflow: hidden;
      }
    }

    .show_nav {
      grid-template-columns: 1fr 2fr;
    }

    .show_nav > #nav {
      display: block;
    }

    .show_nav > #content * {
      font-size: 30%;
      padding: 0;
      overflow: hidden;
    }
  </style>

</head>

<body>

  <div class="grid">

    <div id="toggle"></div>

    <ul id="nav">

      <li>
        <a style="font-weight: bold; font-size: 30px;" href="/docs">XYZ</a>
      </li>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <li class="_1 __1 ">
        <a href="/docs/03-develop/00-infrastructure/">Develop</a>
      </li>
      
      
      
      <li class="_1  ">
        <a href="/docs/03-develop/01-client/">Client</a>
      </li>
      
      
      
      <li class="_1  ">
        <a href="/docs/03-develop/02-server/">Server</a>
      </li>
      
      
      
      <li class="_2 __2 ">
        <a href="/docs/03-develop/04-dependencies/00-introduction/">Introduction</a>
      </li>
      
      
      
      <li class="_2  ">
        <a href="/docs/03-develop/04-dependencies/01-sass/">Sass</a>
      </li>
      
      
      
      <li class="_2  ">
        <a href="/docs/03-develop/04-dependencies/02-web-pack/">Webpack</a>
      </li>
      
      
      
      <li class="_2 __2 active">
        <a href="/docs/03-develop/05-security/00-security/">Security</a>
      </li>
      
      
      
      <li class="_2  ">
        <a href="/docs/03-develop/05-security/01-jwt-token/">JWT Token</a>
      </li>
      
      
      
      <li class="_2  ">
        <a href="/docs/03-develop/05-security/02-sql-injections/">SQL injections</a>
      </li>
      
      
      
      <li class="_2  ">
        <a href="/docs/03-develop/05-security/03-strategy/">Strategy</a>
      </li>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      

    </ul>

    <div id="content">
      <p>We are using the <a href="https://github.com/fastify/fastify-auth">fastify-auth</a> module for authentication in XYZ. All authentication is handled by the <a href="https://github.com/GEOLYTIX/xyz/blob/master/auth.js">auth.js</a> module.</p>
<p>By setting the access key (PUBLIC or PRIVATE) in the <a href="../../environment-settings/"><strong>environmental settings</strong></a> with a PostgreSQL connection string (plus a table name separated by a | pipe) it is possible to restrict access. The access control list (ACL) table must be stored in a PostgreSQL database.</p>
<p>If set to PRIVATE a login is required to open the application or access any endpoint. If set to public login is optional for routes which are not restricted for administrator. Admin routes are not available if no ACL is provided. Without the admin route all changes to the settings need to be done in the code repository or database.</p>
<p>An ACL must have following table schema:</p>
<pre><code class="language-sql">create table if not exists users
(
	&quot;_id&quot; serial not null,
	email text not null,
	password text not null,
	verified boolean,
	approved boolean,
	admin boolean,
	verificationtoken text,
	approvaltoken text,
	failedattempts integer default 0,
	password_reset text,
	api text
);
</code></pre>
<p>We are using a javascript implementation of the OpenBDS <a href="https://en.wikipedia.org/wiki/Blowfish_%28cipher%29">Blowfish (cipher)</a> to encrypt passwords at rest in the ACL. The <a href="https://github.com/GEOLYTIX/xyz/blob/master/views/login.html">login</a> and <a href="https://github.com/GEOLYTIX/xyz/blob/master/views/register.html">register</a> views use <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/email#Validation">input form validation</a> for the email (max 50 character) and password (min 8 character). These are also validated on the backend.</p>

    </div>

  </div>

</body>

<script>
    const toggle = document.getElementById('toggle');

    toggle.onclick = e => { e.target.parentElement.classList.toggle('show_nav'); };
</script>

</html>